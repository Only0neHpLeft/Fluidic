# Design: Fluidic v0.0.1 — App Store Release

Target: App Store release with social/gamification features, onboarding, and reliability fixes.
HealthKit deferred to future version. Languages: English + Czech.

## 1. Bug Fixes & Reliability (Foundation)

- Unify version to 0.0.1 / build 1 across all Xcode targets
- Remove lingering HealthKit references from design docs and code
- Fix localized calendar day headers — use `Calendar.current.shortWeekdaySymbols` instead of hardcoded letters
- Notification reliability — reschedule on app foreground (`scenePhase` change), not only on `addWater()`
- Saving reliability — explicit `modelContext.save()` after every mutation (don't rely on auto-save)
- Wave animation near 100% — smooth dampening curve so it doesn't flatten abruptly
- Empty state for History view — friendly message when no data exists

## 2. Achievement System

### Data Model

New SwiftData `Achievement` model:
- `id: String` — unique key (e.g., `"first_sip"`, `"streak_7"`)
- `title: String` — display name
- `descriptionText: String` — what it means
- `iconName: String` — SF Symbol name
- `unlockedAt: Date?` — nil = locked, date = when earned
- `category: String` — grouping: hydration, streak, milestone

### Badges (10)

| Key | Title | Trigger | Icon |
|-----|-------|---------|------|
| `first_sip` | First Sip | Log first ever intake | `drop.fill` |
| `goal_reached` | Daily Champion | Reach daily goal for first time | `trophy.fill` |
| `streak_3` | Consistent | 3-day streak | `flame.fill` |
| `streak_7` | Week Warrior | 7-day streak | `flame.fill` |
| `streak_30` | Monthly Master | 30-day streak | `star.fill` |
| `early_bird` | Early Bird | Log water before 8am | `sunrise.fill` |
| `night_owl` | Night Owl | Log water after 10pm | `moon.fill` |
| `big_gulp` | Big Gulp | Log 500ml+ in one entry | `drop.triangle.fill` |
| `overachiever` | Overachiever | Reach 150% of daily goal | `bolt.fill` |
| `centurion` | Centurion | Log 100 total entries | `100.circle.fill` |

### Architecture

- `AchievementManager` service checks unlock conditions after each `addWater()` call
- Newly unlocked achievements show an in-app toast/banner (not push notification)
- Achievements are permanent once unlocked

### UI

- Section in History view showing badge grid
- Locked badges: grayed out with lock overlay
- Unlocked badges: colored with subtle glow animation, tap to see unlock date
- All badge titles and descriptions localized in EN + CS

## 3. Onboarding Flow

Shows on first launch only. Tracked via `UserSettings.hasCompletedOnboarding: Bool`.

### Screens (4)

1. **Welcome** — App logo + tagline "Track your hydration, build healthy habits" + Continue
2. **Set Your Goal** — Slider (500-5000ml, default 2500) with visual cup fill + presets (2000, 2500, 3000)
3. **Cup Size** — Pick preferred cup size with visual grid (100, 150, 200, 250, 330, 500ml)
4. **Notifications** — Enable toggle + request permission + Smart/Fixed mode + Skip option

### Design

- Top 60% illustration, bottom 40% controls
- "Continue" button at bottom, "Skip" text link above
- Progress dots at top
- Horizontal slide transitions
- Values saved to UserSettings as user progresses
- On completion: navigate to HomeView with "You're all set!" animation

### Localization

All onboarding text fully localized in EN + CS.

## 4. Accessibility & UX Polish

### Accessibility
- VoiceOver labels on all interactive elements (cup, buttons, badges)
- `accessibilityValue` on progress indicators ("67% of daily goal")
- Dynamic Type support — text scales with system font size
- Minimum 44pt tap targets on all interactive elements
- WCAG AA color contrast (existing theme already compliant)

### UX Polish
- Haptic feedback: light impact on quick-add, medium on cup tap, success on goal reached
- Empty states: friendly messages for History (no data) and Achievements (all locked)
- Error handling: graceful fallback if notification permission denied (show Settings deep link)
- App lifecycle: reschedule notifications on scenePhase foreground, reload today's data
- Refined goal-reached celebration animation timing

### Localization
- All new strings (achievements, onboarding, empty states) localized EN + CS
